# üî≠ Colab Spectral Fitting Project

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡πÄ‡∏õ‡∏Å‡∏ï‡∏£‡∏±‡∏°‡∏£‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏≠‡∏Å‡∏ã‡πå (X-ray Spectral Fitting) ‡∏ö‡∏ô Google Colab ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á

**‚ú® ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà:** ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ Fit ‡πÅ‡∏ö‡∏ö‡∏•‡∏π‡∏Å‡πÇ‡∏ã‡πà (Chain Fit) ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ó‡∏≤‡∏á‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô

## üìÇ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

```
Colab_Spectral_Fitting/
‚îú‚îÄ‚îÄ data_loader.py           # üìä Core Logic: ‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå
‚îú‚îÄ‚îÄ spectral_analysis.ipynb  # üìì User Interface: Notebook ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
‚îú‚îÄ‚îÄ Models/                  # üì¶ Spectral Models Library
‚îî‚îÄ‚îÄ README.md                # üìñ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
```

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Workflow ‡πÉ‡∏´‡∏°‡πà)

1. **Upload & Mount**: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏∂‡πâ‡∏ô Drive ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô Cell ‡πÅ‡∏£‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
2. **Config (Section 1)**: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡πà‡∏ß‡∏á Energy ‡πÅ‡∏•‡∏∞ Path ‡πÑ‡∏ü‡∏•‡πå
3. **Load & Inspect (Section 2)**: ‡∏£‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏£‡∏≤‡∏ü Energy Range (‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô)
4. **Step-by-Step Exploration (Section 3)**: ‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡∏•‡∏∞ Cell ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏•‡∏≠‡∏á Model ‡πÅ‡∏ö‡∏ö Chain Fit
5. **Final Fit (Section 4)**: ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå

---

## üîÑ Algorithm Flow (‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à Code ‡∏ó‡∏µ‡πà‡πÅ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÑ‡∏ß‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏∑‡∏≠ **‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° (Main)** ‡πÅ‡∏•‡∏∞ **‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏¢‡πÉ‡∏ô (Inner Loop)**

### 1. Main Workflow (‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£ Fit ‡πÅ‡∏ö‡∏ö‡∏•‡∏π‡∏Å‡πÇ‡∏ã‡πà)
```text
[ Start: Load Data ]
        |
        v
[ Config: Filter Energy Range ]
        |
        v
[ üß™ Step 1: Fit Powerlaw ] -----------------------> [ üîÑ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Optimization Loop ]
        |                                                   | (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ã‡πâ‡∏≥‡πÜ ‡∏à‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
        | (‡πÑ‡∏î‡πâ‡∏ä‡∏∏‡∏î‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ P1)                                    |
        v                                                   |
[ üß™ Step 2: + Reflection ] <----(‡πÄ‡∏≠‡∏≤ P1 ‡∏°‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô)---------/
        |
        v
[ üß™ Step 3: + Absorption ] ---> ... ---> [ ‚úÖ Final Result & Plot ]
```

### 2. Optimization Loop (‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å: ‡∏•‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì)
‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `find_best_parameters` ‡πÅ‡∏•‡∏∞ `minimize`:

```text
       [ Input: Initial Params ]
                   |
                   v
    /--------------<------------------------\
    |                                       |
    |  üìå 1. Calculate Model (‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå)       |
    |     (func: calculate_model_flux)      |
    |     - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü                 |
    |     - ‡∏Ñ‡∏π‡∏ì ARF (‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÇ‡∏ó‡∏£‡∏ó‡∏£‡∏£‡∏®‡∏ô‡πå)       |
    |              |                        |
    |              v                        |
    |  üìå 2. Statistic (‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥)               |
    |     (func: calculate_chi_squared)     |
    |     - ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏£‡∏≤‡∏ü Model ‡∏Å‡∏±‡∏ö Data ‡∏à‡∏£‡∏¥‡∏á      |
    |     - ‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î (Chi^2)          |
    |              |                        |
    |              v                        |
    |  üìå 3. Decision (‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏°‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à)     |
    |     (scipy.optimize.minimize)         |
    |     "‡∏Ñ‡πà‡∏≤ Chi^2 ‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?"           |
    |      /               \                |
    |    NO (‡∏¢‡∏±‡∏á‡∏•‡∏î‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å)    YES (‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß)     |
    |    |                   |              |
    | ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ (+/-)       \-----> [ Return: Best Params ]
    | (‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠ 1 ‡πÉ‡∏´‡∏°‡πà)
    |    |
    \----/
```

---

# üìö Theoretical References (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ó‡∏§‡∏©‡∏é‡∏µ‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡πà‡∏°‡∏≤)

‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° ‡πÇ‡∏î‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏ó‡∏≤‡∏á‡∏î‡∏≤‡∏£‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ XSPEC ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ [web:20][web:22].

---

## 1. TBabs (Interstellar Absorption)

**‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**  
‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏î‡∏Å‡∏•‡∏∑‡∏ô‡∏£‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏≠‡∏Å‡∏ã‡πå‡πÇ‡∏î‡∏¢‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πä‡∏™‡πÅ‡∏•‡∏∞‡∏ù‡∏∏‡πà‡∏ô‡πÉ‡∏ô‡∏≠‡∏ß‡∏Å‡∏≤‡∏®‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≤‡∏ß (Interstellar Medium; ISM) [web:23][web:30].

**‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å:**  
`F_obs(E) = F_int(E) * exp[-sigma(E) * N_H]`  <!-- Wilms 2000 --> [web:23][web:31]

**‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£:**

- `F_obs(E)`: ‡∏ü‡∏•‡∏±‡∏Å‡∏ã‡πå‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏á‡∏ú‡πà‡∏≤‡∏ô ISM  
- `F_int(E)`: ‡∏ü‡∏•‡∏±‡∏Å‡∏ã‡πå‡∏à‡∏≤‡∏Å‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏π‡∏Å‡∏î‡∏π‡∏î‡∏Å‡∏•‡∏∑‡∏ô  
- `sigma(E)`: photoelectric absorption cross-section ‡∏ï‡πà‡∏≠‡∏≠‡∏∞‡∏ï‡∏≠‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô E  
- `N_H`: column density ‡∏Ç‡∏≠‡∏á‡πÑ‡∏Æ‡πÇ‡∏î‡∏£‡πÄ‡∏à‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏ô‡∏ß‡∏™‡∏≤‡∏¢‡∏ï‡∏≤  

**‡∏ó‡∏µ‡πà‡∏°‡∏≤ (Physics & Math):**

- ‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå: Atomic physics + radiative transfer ‡πÉ‡∏ô ISM [web:23][web:31].  
- ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå: ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡∏£‡∏±‡∏á‡∏™‡∏µ‡πÅ‡∏ö‡∏ö exponential attenuation.  

**‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏´‡∏•‡∏±‡∏Å:**

- Wilms, J., Allen, A., & McCray, R. 2000, *ApJ*, 542, 914, ‚ÄúOn the Absorption of X-Rays in the Interstellar Medium‚Äù  
  - ADS: http://ui.adsabs.harvard.edu/abs/2000ApJ...542..914W [web:29]  
  - PDF: https://cxc.harvard.edu/twiki/pub/SnrE0102/AbsorptionModel/wilms_tbabs_apj_2000.pdf [web:23]  
- ‡∏™‡∏£‡∏∏‡∏õ‡πÇ‡∏°‡πÄ‡∏î‡∏• tbabs/tbnew: https://pulsar.sternwarte.uni-erlangen.de/wilms/research/tbabs/ [web:11]  

---

## 2. Powerlaw (Non-Thermal Emission)

**‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**  
‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡πà‡∏£‡∏±‡∏á‡∏™‡∏µ‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô ‡πÄ‡∏ä‡πà‡∏ô synchrotron, inverse Compton scattering ‡∏à‡∏≤‡∏Å‡∏≠‡∏ô‡∏∏‡∏†‡∏≤‡∏Ñ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏π‡∏á‡πÉ‡∏ô‡∏™‡∏ô‡∏≤‡∏°‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏•‡∏≤‡∏™‡∏°‡∏≤‡∏£‡πâ‡∏≠‡∏ô [web:25].

**‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å (XSPEC powerlaw):**  
`N(E) = K * E^(-Gamma)`  <!-- XSPEC powerlaw manual --> [web:12][web:37]

**‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£:**

- `N(E)`: photon flux density (photons cm‚Åª¬≤ s‚Åª¬π keV‚Åª¬π)  
- `K`: normalization constant  
- `Gamma (Œì)`: photon index  

**‡∏ó‡∏µ‡πà‡∏°‡∏≤ (Physics & Math):**

- ‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå: Non-thermal emission processes (synchrotron, inverse Compton, non-thermal bremsstrahlung) ‡πÉ‡∏ô astrophysical plasmas [web:21][web:25].  
- ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå: Power-law distribution ‡∏Ç‡∏≠‡∏á‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏†‡∏≤‡∏Ñ‡πÅ‡∏•‡∏∞‡∏™‡πÄ‡∏õ‡∏Å‡∏ï‡∏£‡∏±‡∏° [web:25].  

**‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏´‡∏•‡∏±‡∏Å:**

- XSPEC ‚Äòpowerlaw‚Äô description:  
  - https://heasarc.gsfc.nasa.gov/docs/software/xspec/manual/node222.html [web:12]  
  - XSPEC Models index: https://heasarc.gsfc.nasa.gov/docs/software/xspec/manual/node128.html [web:20]  
- Sahakyan, N. et al. 2021, ‚ÄúSpectral index‚Äìflux relation for investigating the origins of non-thermal emission‚Äù [web:25].  
- Sherpa xspowerlaw help (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á XSPEC powerlaw):  
  - https://cxc.cfa.harvard.edu/sherpa/ahelp/xspowerlaw.html [web:37]  

---

## 3. Reflection (Relativistic Reflection; ‡πÄ‡∏ä‡πà‡∏ô relxill)

**‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**  
‡∏™‡πÄ‡∏õ‡∏Å‡∏ï‡∏£‡∏±‡∏°‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏à‡∏≤‡∏ô‡∏û‡∏≠‡∏Å‡∏û‡∏π‡∏ô‡∏°‡∏ß‡∏• (accretion disk) ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏â‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏≠‡∏Å‡∏ã‡πå‡∏à‡∏≤‡∏Å corona ‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡∏π‡∏Å‡∏ö‡∏¥‡∏î‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß‡πÇ‡∏î‡∏¢‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ó‡∏ò‡∏†‡∏≤‡∏û‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏£‡∏≠‡∏ö‡∏´‡∏•‡∏∏‡∏°‡∏î‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡∏¥‡∏ß‡∏ï‡∏£‡∏≠‡∏ô [web:3][web:33].

**‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•:**  

- ‡∏£‡∏ß‡∏° photoionized reflection spectrum (‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏• *xillver*) ‡∏Å‡∏±‡∏ö relativistic convolution kernel (*relconv*) ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏£‡∏ß‡∏° *relxill* [web:13].  
- ‡∏™‡πÄ‡∏õ‡∏Å‡∏ï‡∏£‡∏±‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏¥‡∏ô‡∏ó‡∏¥‡πÄ‡∏Å‡∏£‡∏ï‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏à‡∏∏‡∏î‡∏ö‡∏ô‡∏î‡∏¥‡∏™‡∏Å‡πå ‡∏Ñ‡∏π‡∏ì‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö Doppler + gravitational redshift:

  `F(E) ‚àù ‚à´ g^3 * I(E/g) dŒ©`  <!-- ‡∏à‡∏≤‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ relxill --> [web:13]

**‡∏ó‡∏µ‡πà‡∏°‡∏≤ (Physics & Math):**

- ‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå: General Relativity (Kerr metric, gravitational redshift, light bending, Doppler boosting) + Compton reflection ‡πÅ‡∏•‡∏∞ photoionization physics ‡∏ö‡∏ô‡∏ú‡∏¥‡∏ß‡∏î‡∏¥‡∏™‡∏Å‡πå [web:3][web:33].  
- ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå: ‡∏Å‡∏≤‡∏£‡∏≠‡∏¥‡∏ô‡∏ó‡∏¥‡πÄ‡∏Å‡∏£‡∏ï‡∏ï‡∏≤‡∏° geodesics ‡∏ö‡∏ô spacetime ‡∏Ç‡∏≠‡∏á Kerr + radiative transfer ‡∏ö‡∏ô‡∏î‡∏¥‡∏™‡∏Å‡πå.  

**‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏´‡∏•‡∏±‡∏Å:**

- Garc√≠a, J. et al. 2014, ‚ÄúRelativistic reflection with the relxill model‚Äù (documentation pdf)  
  - https://www.sternwarte.uni-erlangen.de/~dauser/research/relxill/relxill_docu_v1.0.pdf [web:13]  
- Dauser, T. et al. 2014, *MNRAS Letters*, 444, L100,  
  ‚ÄúThe role of the reflection fraction in constraining black hole spin‚Äù  
  - https://academic.oup.com/mnrasl/article/444/1/L100/962071 [web:33]  
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• reflection:  
  - *MNRAS* 534, 634 (2024), ‚ÄúRelativistic X-ray reflection from the accreting millisecond X-ray pulsar ‚Ä¶‚Äù [web:3]  

---

## 4. Gaussian Line (Emission / Absorption Line)

**‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**  
‡πÄ‡∏™‡πâ‡∏ô‡∏™‡πÄ‡∏õ‡∏Å‡∏ï‡∏£‡∏±‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡πà‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏π‡∏î‡∏Å‡∏•‡∏∑‡∏ô‡∏£‡∏±‡∏á‡∏™‡∏µ‡∏ó‡∏µ‡πà‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏à‡∏≥‡πÄ‡∏û‡∏≤‡∏∞ (‡πÄ‡∏ä‡πà‡∏ô Fe KŒ± ~6.4 keV) ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å Doppler / thermal / turbulent broadening [web:26].

**‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å (Gaussian profile):**  
`N(E) = (A / (sigma * sqrt(2œÄ))) * exp( -(E - E0)^2 / (2 * sigma^2) )`  <!-- Gaussian line --> [web:20][web:40]

**‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£:**

- `A`: ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ï‡πâ‡πÇ‡∏Ñ‡πâ‡∏á (total line intensity)  
- `E0`: ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô (line centroid energy)  
- `sigma`: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (standard deviation)  

**‡∏ó‡∏µ‡πà‡∏°‡∏≤ (Physics & Math):**

- ‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå: Doppler broadening ‡∏à‡∏≤‡∏Å thermal motion, turbulence, ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á instrumental broadening [web:26].  
- ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå: Gaussian distribution ‡∏à‡∏≤‡∏Å central limit theorem; ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô line profile ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÉ‡∏ô spectroscopy [web:34].  

**‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏´‡∏•‡∏±‡∏Å:**

- XSPEC Models index (‡∏£‡∏ß‡∏° `gauss`):  
  - https://heasarc.gsfc.nasa.gov/docs/software/xspec/manual/node128.html [web:20]  
- Sherpa XSgaussian help (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á Gaussian XSPEC model):  
  - https://sherpa.readthedocs.io/en/4.12.0/model_classes/api/sherpa.astro.xspec.XSgaussian.html [web:40]  
- ‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö line-shape ‡πÅ‡∏•‡∏∞ Gaussian profiles ‡πÉ‡∏ô spectroscopy:  
  - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ä‡πà‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Gaussian / Lorentzian line shapes [web:34].  

---

## 5. Blackbody (Thermal Emission)

**‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**  
‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡πà‡∏£‡∏±‡∏á‡∏™‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏≥‡πÉ‡∏ô‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ó‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πâ‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á accretion disk ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß‡∏î‡∏≤‡∏ß‡∏ô‡∏¥‡∏ß‡∏ï‡∏£‡∏≠‡∏ô [web:27].

**‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å (Planck Law ‡πÉ‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô):**  
`B(E,T) = (2 * E^3 / (h^3 * c^2)) * (1 / (exp(E/kT) - 1))`  <!-- Planck law --> [web:27][web:35]

**‡πÉ‡∏ô XSPEC (bbody/bbodyrad):**

- `bbody` / `bbodyrad` ‡πÉ‡∏ä‡πâ Planck spectrum ‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡∏°‡∏µ normalization ‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏ß (‡∏£‡∏±‡∏®‡∏°‡∏µ¬≤) ‡πÅ‡∏ö‡πà‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á¬≤ [web:20][web:43].  
- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö `bbodyrad`:  
  - https://heasarc.gsfc.nasa.gov/docs/software/xspec/manual/node137.html [web:43]  

**‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£:**

- `E`: ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏ü‡∏ï‡∏≠‡∏ô  
- `T`: ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏Ç‡∏≠‡∏á blackbody  
- `kT`: ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢ keV  
- `h`: Planck constant  
- `c`: ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏™‡∏á  

**‡∏ó‡∏µ‡πà‡∏°‡∏≤ (Physics & Math):**

- ‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå: Quantum statistical mechanics ‚Äì ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÅ‡∏ö‡∏ö Bose‚ÄìEinstein ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏ü‡∏ï‡∏≠‡∏ô‡πÉ‡∏ô cavity ‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏ó‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô [web:27][web:35].  
- ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå: ‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÇ‡∏ü‡∏ï‡∏≠‡∏ô (density of states) + ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡πÇ‡∏ü‡∏ï‡∏≠‡∏ô‡πÉ‡∏ô‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ [web:35].  

**‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏´‡∏•‡∏±‡∏Å:**

- ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Blackbody Radiation ‡πÅ‡∏•‡∏∞ Planck‚Äôs Law:  
  - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á lecture note: https://tlakoba.w3.uvm.edu/AppliedUGMath/notes/lecture_13.pdf [web:35]  
  - ‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô Blackbody Radiation [web:27]  
- XSPEC Manual ‚Äì `bbody`, `bbodyrad` model descriptions:  
  - Models index: https://heasarc.gsfc.nasa.gov/docs/software/xspec/manual/node128.html [web:20]  
  - `bbodyrad`: https://heasarc.gsfc.nasa.gov/docs/software/xspec/manual/node137.html [web:43]  

---


## üõ†Ô∏è Dependencies
- `numpy`: Calculation
- `matplotlib`: Visualization
- `astropy`: FITS I/O
- `scipy`: Optimization algorithms

---
*Created for AGN Spectral Analysis Research*
